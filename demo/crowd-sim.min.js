!function(){"use strict";var i={};i.Entity=Entity,i.World=World,i.Engine=Engine,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.CrowdSim=i),"function"==typeof define&&define.amd&&define("CrowdSim",[],function(){return i}),"object"==typeof window&&"object"==typeof window.document&&(window.CrowdSim=i)}();var Engine={running:!1,iterations:0,STEP:60,world:{}};!function(){Engine.setWorld=function(i){this.world=i},Engine.getWorld=function(){return this.world},Engine.init=function(i,t){return this.world=i,this.world.save(),this.options=t,this.world},Engine.run=function(){this.running||(this.running=!0,this._step())},Engine.step=function(){this.running||this._step()},Engine._step=function(){if(this.world&&this.world.entities)for(var i in this.world.entities){var t=this.world.entities[i];t.selected?this.world.entitiy_selected=t:(t.acceleration.x=(Math.random()-.5)/1e3,t.acceleration.y=(Math.random()-.5)/1e3,t.velocity.x+=t.acceleration.x*Engine.STEP,t.velocity.y+=t.acceleration.y*Engine.STEP,t.direction=Math.atan2(t.velocity.y,t.velocity.x),t.position.x+=t.velocity.x*Engine.STEP,t.position.y+=t.velocity.y*Engine.STEP,this.world.wrap&&(t.position.x>this.world.MAX_X&&(t.position.x=this.world.MIN_X+t.position.x-this.world.MAX_X),t.position.x<this.world.MIN_X&&(t.position.x=this.world.MAX_X-(this.world.MIN_X-t.position.x)),t.position.y>this.world.MAX_Y&&(t.position.y=this.world.MIN_Y+t.position.y-this.world.MAX_Y),t.position.y<this.world.MIN_Y&&(t.position.y=this.world.MAX_Y-(this.world.MIN_Y-t.position.y))),this.options.onStep&&this.options.onStep(this))}if(this.iterations++,this.running){var n=this;setTimeout(function(){n._step()},this.STEP)}},Engine.stop=function(){this.running&&(this.running=!1)},Engine.reset=function(){this.iterations=0,this.running=!1,this.world.restore()}}();var Entity={};!function(){"use strict";Entity=function(i,t,n,o,e){this.id=i,this.position={x:t,y:n},this.velocity={x:0,y:0},this.acceleration={x:0,y:0},this.size=o,this.direction=e,this.view={}}}();var World={};!function(){"use strict";World=function(i,t){this.entities=[],this.wrap=!0,this.MAX_X=i,this.MIN_X=0,this.MAX_Y=t,this.MIN_Y=0},World.prototype.add=function(i){this.entities.push(i)},World.prototype.save=function(){this.entities_save=JSON.stringify(this.entities)},World.prototype.restore=function(){this.entities=JSON.parse(this.entities_save)}}();